<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SbÃ­rka na Streamer House</title>

    <!-- NaÄtenÃ­ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* PouÅ¾itÃ­ fontu Inter pro modernÃ­ vzhled */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fb;
        }
        /* Custom styl pro gradient progress baru */
        .progress-bar-fill {
            transition: width 1s ease-in-out;
            background: linear-gradient(90deg, #f97316 0%, #ea580c 100%);
        }
        /* Animace pro tlaÄÃ­tko */
        .btn-donate {
            display: inline-block;
            transition: all 0.3s ease;
        }
        .btn-donate:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(79, 70, 229, 0.5); 
            background-color: #4338ca;
        }
        .btn-donate:active {
            transform: translateY(0);
        }
    </style>
</head>
<body class="p-4 sm:p-8 min-h-screen flex items-center justify-center">

    <div id="app" class="w-full max-w-3xl bg-white shadow-2xl rounded-2xl p-6 sm:p-10 border border-gray-100">

        <!-- Hlava strÃ¡nky -->
        <header class="text-center mb-6">
            <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-900 mb-2 tracking-tight">
                Streamer House Fundraiser ğŸ 
            </h1>
            <p class="text-xl text-gray-500 font-medium">
                CÃ­l: <strong>Vybudovat profesionÃ¡lnÃ­ tvÅ¯rÄÃ­ centrum</strong> â€“ <span class="font-extrabold text-orange-600">10 000 000 KÄ</span>
            </p>
        </header>

        <!-- Informace o cÃ­li a sbÃ­rce -->
        <div class="mb-8 p-6 bg-orange-50 rounded-xl border border-orange-300 shadow-inner">
            <div class="flex justify-between items-center mb-3">
                <span class="text-sm font-semibold text-orange-700 uppercase tracking-wider">
                    AktuÃ¡lnÃ­ stav
                </span>
                <span id="progress-percentage" class="text-2xl font-extrabold text-orange-800">
                    NaÄÃ­tÃ¡nÃ­...
                </span>
            </div>
            
            <div id="progress-bar" class="w-full h-4 bg-gray-300 rounded-full overflow-hidden mb-4 shadow-md">
                <div id="progress-fill" class="progress-bar-fill h-full rounded-full" style="width: 0%;"></div>
            </div>

            <div class="flex justify-between text-xl font-bold">
                <span id="current-amount" class="text-gray-900">
                    NaÄÃ­tÃ¡nÃ­...
                </span>
                <span id="target-amount" class="text-gray-600">
                    10 000 000 KÄ
                </span>
            </div>
        </div>
        
        <!-- Sekce OsobnÃ­ PÅ™Ã­bÄ›h a SpoluprÃ¡ce -->
        <div class="mb-8 p-6 bg-gray-50 rounded-xl border border-gray-200 shadow-lg">
            <h2 class="text-3xl font-bold text-gray-800 mb-4 border-b pb-2">NÃ¡Å¡ spoleÄnÃ½ sen: Streamer House</h2>
            <p class="text-gray-700 leading-relaxed">
                Ahoj, jmenuji se Damian a jako tvÅ¯rce obsahu jsem si stanovil velkÃ½ cÃ­l: vybudovat Streamer House. To nebude jen dÅ¯m, ale <strong>centrÃ¡lnÃ­ a profesionÃ¡lnÃ­ zÃ¡kladna</strong> pro mne a dalÅ¡Ã­ zaÄÃ­najÃ­cÃ­ streamery z naÅ¡Ã­ komunity.
            </p>
            <p class="text-700 leading-relaxed mt-3">
                UÅ¾ Å¾Ã¡dnÃ© kompromisy s kvalitou. Streamer House nÃ¡m koneÄnÄ› poskytne <strong>dedikovanÃ©, odhluÄnÄ›nÃ© setupy</strong> pro individuÃ¡lnÃ­ vysÃ­lÃ¡nÃ­ a sdÃ­lenÃ©, plnÄ› vybavenÃ© studio pro velkÃ© kolaborace, podcasty a komunitnÃ­ eventy. VÃ¡Å¡ pÅ™Ã­spÄ›vek je investicÃ­ do <strong>budoucnosti lokÃ¡lnÃ­ tvÅ¯rÄÃ­ scÃ©ny</strong>.
            </p>
            
            <!-- VYZVA KE SPOLUPRÃCI - VÃCE ZVÃRAZNÄšNÃ A INKLUZIVNÃ -->
            <div class="mt-5 p-4 bg-indigo-100 rounded-lg border-l-4 border-indigo-600 shadow-md">
                <p class="text-lg font-extrabold text-indigo-700">
                    ğŸ¤ NabÃ­dka OtevÅ™enÃ©ho PÅ™Ã­stupu a SpoluprÃ¡ce!
                </p>
                <p class="text-indigo-800 leading-snug mt-1">
                    Tento projekt je stavÄ›n pro celou komunitu! Streamer House bude mÃ­t <strong>otÄ›vÅ™enÃ½ pÅ™Ã­stup pro vÅ¡echny ambiciÃ³znÃ­ streamery a tvÅ¯rce obsahu</strong>, kteÅ™Ã­ chtÄ›jÃ­ rÅ¯st, vyuÅ¾Ã­vat profesionÃ¡lnÃ­ zÃ¡zemÃ­ a tvoÅ™it. AÅ¥ uÅ¾ jste velkÃ½ nebo malÃ½ tvÅ¯rce, <strong>ozvÄ›te se!</strong> HledÃ¡me partnery, kolegy a lidi, kteÅ™Ã­ se chtÄ›jÃ­ aktivnÄ› podÃ­let na tvorbÄ› obsahu novÃ© generace.
                </p>
            </div>
            
            <p class="text-gray-700 leading-relaxed mt-4 font-semibold text-center text-orange-600">
                PodpoÅ™te nÃ¡s v tomto velkÃ©m kroku. DÄ›kujeme za dÅ¯vÄ›ru a za to, Å¾e tvoÅ™Ã­te naÅ¡i komunitu!
            </p>
        </div>
        
        <!-- Sekce KlÃ­ÄovÃ© Benefity -->
        <div class="mb-8">
            <h3 class="text-2xl font-bold text-gray-800 mb-4 text-center">Co Streamer House pÅ™inese?</h3>
            <div class="grid md:grid-cols-3 gap-4">
                <div class="p-4 bg-purple-50 rounded-lg shadow-md border border-purple-200 text-center">
                    <span class="text-3xl mb-2 block">ğŸ™ï¸</span>
                    <p class="font-semibold text-purple-700">ProfesionÃ¡lnÃ­ Studio</p>
                    <p class="text-sm text-gray-600">DedikovanÃ©, odhluÄnÄ›nÃ© prostory pro natÃ¡ÄenÃ­ a podcasty.</p>
                </div>
                <div class="p-4 bg-purple-50 rounded-lg shadow-md border border-purple-200 text-center">
                    <span class="text-3xl mb-2 block">âš¡</span>
                    <p class="font-semibold text-purple-700">StabilnÃ­ Konekce</p>
                    <p class="text-sm text-gray-600">Ultra-rychlÃ½ a spolehlivÃ½ internet pro 4K streamovÃ¡nÃ­ bez vÃ½padkÅ¯.</p>
                </div>
                <div class="p-4 bg-purple-50 rounded-lg shadow-md border border-purple-200 text-center">
                    <span class="text-3xl mb-2 block">ğŸ¤</span>
                    <p class="font-semibold text-purple-700">Kolaborace</p>
                    <p class="text-sm text-gray-600">SnadnÃ¡ tvorba spoleÄnÃ©ho obsahu, daily vlogy a akce s komunitou.</p>
                </div>
            </div>
        </div>

        <!-- Odkaz pro darovÃ¡nÃ­ -->
        <div class="text-center p-6 bg-gray-100 rounded-xl shadow-inner">
            <p class="mb-5 text-gray-600 text-lg font-medium">
                KaÅ¾dÃ½ dar nÃ¡s posouvÃ¡ blÃ­Å¾ k realizaci tohoto komunitnÃ­ho centra. DÄ›kujeme za podporu!
            </p>
            
            <!-- TlaÄÃ­tko PÅ˜ESMÄšROVÃNÃ na Revolut.me -->
            <a href="https://revolut.me/damianstanek" target="_blank"
                id="donate-link"
                class="btn-donate w-full sm:w-2/3 lg:w-1/2 px-8 py-4 bg-indigo-600 text-white font-extrabold rounded-xl shadow-xl hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-300 text-lg">
                Darovat na Streamer House ğŸ’¸
            </a>

            <!-- ZprÃ¡va o administraci - TATO SEKCE JE ODSTRANÄšNA -->
            
        </div>
    </div>

    <!-- Moduly Firebase SDK - PouÅ¾Ã­vajÃ­ se jen, pokud je detekovÃ¡na konfigurace -->
    <script type="module">
        // Importy jsou nynÃ­ chrÃ¡nÄ›ny, aby nepadaly na lokÃ¡lnÃ­m disku
        let initializeApp, getAuth, signInAnonymously, signInWithCustomToken, getFirestore, doc, onSnapshot, setLogLevel;

        // --- GLOBÃLNÃ KONFIGURACE A PROMÄšNNÃ‰ ---
        const TARGET_AMOUNT = 10000000;
        const REVOLUT_LINK = "https://revolut.me/damianstanek";
        let db;
        let isLocalMode = false;
        
        // NaÄtenÃ­ globÃ¡lnÃ­ch promÄ›nnÃ½ch z Canvas prostÅ™edÃ­
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfigRaw = typeof __firebase_config !== 'undefined' ? __firebase_config : '{}';
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        const firebaseConfig = JSON.parse(firebaseConfigRaw);

        // Cesty k DB
        const COLLECTION_PATH = `/artifacts/${appId}/public/data/house_fundraiser`;
        const DOC_REF_PATH = 'progress';

        // Elementy UI
        const currentAmountEl = document.getElementById('current-amount');
        const progressFillEl = document.getElementById('progress-fill');
        const progressPercentageEl = document.getElementById('progress-percentage');
        const donateLinkEl = document.getElementById('donate-link');
        // localModeWarningEl uÅ¾ nenÃ­ potÅ™eba

        /**
         * FormÃ¡tuje ÄÃ­slo jako mÄ›nu KÄ.
         */
        function formatCZK(amount) {
            return new Intl.NumberFormat('cs-CZ', {
                style: 'currency',
                currency: 'CZK',
                minimumFractionDigits: 0
            }).format(amount);
        }
        
        /**
         * Aktualizuje uÅ¾ivatelskÃ© rozhranÃ­ na zÃ¡kladÄ› aktuÃ¡lnÄ› vybranÃ© ÄÃ¡stky.
         */
        function updateUI(totalRaised) {
            const percentage = Math.min((totalRaised / TARGET_AMOUNT) * 100, 100);

            currentAmountEl.textContent = formatCZK(totalRaised);
            progressFillEl.style.width = `${percentage}%`;
            progressPercentageEl.textContent = `${percentage.toFixed(2)}%`;

            if (totalRaised >= TARGET_AMOUNT) {
                donateLinkEl.textContent = "CÃ­l dosaÅ¾en! ğŸ‰";
                donateLinkEl.removeAttribute('href');
                donateLinkEl.classList.remove('bg-indigo-600', 'hover:bg-indigo-700');
                donateLinkEl.classList.add('bg-green-600', 'cursor-not-allowed');
            } else {
                 donateLinkEl.setAttribute('href', REVOLUT_LINK);
                 donateLinkEl.textContent = "Darovat na Streamer House ğŸ’¸";
                 donateLinkEl.classList.add('bg-indigo-600', 'hover:bg-indigo-700');
                 donateLinkEl.classList.remove('bg-green-600', 'cursor-not-allowed');
            }
        }

        /**
         * Inicializuje Firebase NEBO spouÅ¡tÃ­ lokÃ¡lnÃ­ simulaci.
         */
        async function initializeAppAndAuth() {
            // Kontrola pro lokÃ¡lnÃ­ spuÅ¡tÄ›nÃ­: ChybÃ­-li konfiguraÄnÃ­ klÃ­Ä nebo token.
            if (Object.keys(firebaseConfig).length === 0 || !initialAuthToken) {
                isLocalMode = true;
                console.warn("SpuÅ¡tÄ›no v LOKÃLNÃM MÃ“DU. DB pÅ™ipojenÃ­ pÅ™eskoÄeno.");
                
                // NastavÃ­me simulovanou ÄÃ¡stku
                updateUI(SIMULATED_START_AMOUNT); 
                return; // UkonÄÃ­me, dÃ¡l se kÃ³d DB neprovÃ¡dÃ­
            }
            
            // --- ONLINE/CANVAS REÅ½IM (DB) ---
            // DynamickÃ© naÄtenÃ­ importÅ¯ (pro online reÅ¾im)
            try {
                // Oprava importnÃ­ch cest pro zvÃ½Å¡enÃ­ stability naÄÃ­tÃ¡nÃ­ modulÅ¯
                const firebaseModules = await import("https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js");
                initializeApp = firebaseModules.initializeApp;
                const authModules = await import("https://www.gstatic.com/firebasejs/10.12.3/firebase-auth.js");
                getAuth = authModules.getAuth;
                signInAnonymously = authModules.signInAnonymously;
                signInWithCustomToken = authModules.signInWithCustomToken;
                const firestoreModules = await import("https://www.gstatic.com/firebasejs/10.12.3/firebase-firestore.js");
                getFirestore = firestoreModules.getFirestore;
                doc = firestoreModules.doc;
                onSnapshot = firestoreModules.onSnapshot;
                setLogLevel = firestoreModules.setLogLevel;

                setLogLevel('Debug');

                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                const auth = getAuth(app);

                // Autentizace pro ÄtenÃ­ a zÃ¡pis
                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    await signInAnonymously(auth);
                }
                
                setupRealtimeListener();

            } catch (error) {
                console.error("Chyba pÅ™i inicializaci nebo autentizaci:", error);
                currentAmountEl.textContent = "Chyba DB";
                progressPercentageEl.textContent = "ERR";
                donateLinkEl.textContent = "Data nedostupnÃ¡ (Chyba DB)";
                donateLinkEl.classList.add('bg-gray-400', 'pointer-events-none');
            }
        }


        /**
         * NastavÃ­ real-time listener pro sledovÃ¡nÃ­ zmÄ›n v databÃ¡zi (Pouze Online).
         */
        function setupRealtimeListener() {
            if (!db) return;

            const docRef = doc(db, COLLECTION_PATH, DOC_REF_PATH);
            
            // Listener pro zmÄ›ny v reÃ¡lnÃ©m Äase
            onSnapshot(docRef, (docSnap) => {
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    const totalRaised = data.totalRaised || 0;
                    updateUI(totalRaised);
                } else {
                    console.log("Dokument 'progress' neexistuje, zobrazuji 0.");
                    updateUI(0);
                }
            }, (error) => {
                console.error("Chyba v real-time listeneru (onSnapshot):", error);
                updateUI(0); // ZobrazÃ­me nulu v pÅ™Ã­padÄ› chyby
            });
        }

        // =================================================================
        // !! DÅ®LEÅ½ITÃ‰: ÃšPRAVA SIMULOVANÃ‰ ÄŒÃSTKY PRO LOKÃLNÃ TESTOVÃNÃ !!
        // Tuto konstantu mÅ¯Å¾ete zmÄ›nit, pokud testujete bez pÅ™ipojenÃ­ k Firebase.
        // Tato hodnota se POUZE pouÅ¾ije, kdyÅ¾ je aplikace v "LOKÃLNÃM MÃ“DU".
        const SIMULATED_START_AMOUNT = 0; 
        // =================================================================
        
        window.onload = initializeAppAndAuth;

    </script>
</body>
</html>